#General Pre-Configs (need to be set before keybindings in case of overwriting)
setw -g mode-keys vi
set -g status-keys vi
set -g history-limit 50000

##allow tmux-resurrect to save vim sessions
set -g @resurrect-strategy-vim 'session'

#Key Bindings

##Panes
#update pane layout
bind-key enter next-layout

#synchronize panes with ctrl+s
bind -n C-s setw synchronize-panes

#rename current pane with alt+r
bind-key -n M-r command-prompt "select-pane -T '%%'" 

# Use Alt-arrow keys without prefix key to switch panes
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# use vim-like keys for splits and windows
bind-key v split-window -v
bind-key s split-window -h
bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

#re-bind key to switch to previously viewed window (since it got overwritten by vim-like keys)
bind b last-window

# Shift arrow to switch windows
bind -n S-Left  previous-window
bind -n S-Right next-window

# turn rename off to avoid conflicts with mux steps
set-window-option -g allow-rename off

##Sessions

#switch to TODO session with alt+t
bind -n M-t switch -t todo

##Misc

bind-key : command-prompt

# stay in copy mode after yanking text
# stay in copy mode after yanking text
bind-key -T copy-mode y send-keys -X copy-pipe "reattach-to-user-namespace pbcopy" \; send-keys -X clear-selection
bind-key -T copy-mode Y send-keys -X copy-pipe-and-cancel "tmux paste-buffer"
bind-key -T copy-mode-vi y send-keys -X copy-pipe "reattach-to-user-namespace pbcopy" \; send-keys -X clear-selection
bind-key -T copy-mode-vi Y send-keys -X copy-pipe-and-cancel "tmux paste-buffer"
unbind   -T copy-mode MouseDragEnd1Pane
unbind   -T copy-mode-vi MouseDragEnd1Pane

#hotkey to set current session path to current pane path
bind-key e attach-session -c "#{pane_current_path}" \; display-message "#{pane_current_path}"

#hotkey to source conf file
bind r source-file ~/.tmux.conf \; display-message " ‚ú± tmux.conf is reloaded"

#General Configs
##specify logging path/name
set -g @logging-path '/home/jared/.tmux/logging/%Y-%m-%d'
set -g @logging-filename "%H-%M-%S-#{session_name}-#{window_name}[#{window_index}]-#{pane_index}.log"
set -g @screen-capture-path '/home/jared/.tmux/logging/%Y-%m-%d'
set -g @screen-capture-filename "%H-%M-%S-#{session_name}-#{window_name}[#{window_index}]-#{pane_index}.log"
set -g @save-complete-history-path '/home/jared/.tmux/logging/%Y-%m-%d'
set -g @save-complete-history-filename "%H-%M-%S-#{session_name}-#{window_name}[#{window_index}]-#{pane_index}.log"

#extend display time of info banners
set-option -g display-time 2000

# No delay for escape key press
set -sg escape-time 0

set-option -g base-index 1

#when window is closed, tmux automatically renumbers the other windoes in numerical order (respects the base-index option if set)
set -g renumber-windows on

#allows the mouse to be used to resize panes, scroll in panes, etc:
set -g mouse on

##Status Bar

###Theme
set-option -g default-terminal screen-256color

# flash up a message ("Bell in current window") instead of telling the terminal to beep
set -g visual-bell off

set-option -g status-style bg=default
    # status-fg and status-bg are now applied before status-style rather than instead of; this means that if either is set to default the status-style colour will be used.
set -g window-status-current-style 'fg=blue,bg=default'
set -g window-status-current-format ' #I#[fg=blue]:#[fg=green]#W#[fg=red]#F '
set -g window-status-style 'fg=blue,bg=default' 
set -g window-status-format ' #I#[fg=blue]:#[bg=default]#W#[fg=red]#F '
set -g window-status-bell-style 'fg=red bg=default bold'

# set pane border colours
set -g pane-border-style fg=blue
set -g pane-active-border-style "bg=default fg=blue"
#set pane index/title at the bottom line of each pane
set -g pane-border-format "#{pane_index} #{pane_title}"
set -g pane-border-status bottom


###Displays
set -g status-interval 60
set -g status-left-length 30
#show that prefix key has been activated and highlights current window
set -g status-left '#{?client_prefix,#[fg=red]prefix   ,#[fg=green][#S]}'

set -g status-right "#[fg=colour8][\üì¶:#(docker ps -q|wc -l|xargs) \üíÄ:#(docker ps -a -q --filter "status=exited"|wc -l|xargs) \üê≥:#(docker image ls|wc -l|xargs|sed -e 's/$/-1/g'|bc)\] | #(cut -d ' ' -f 1-3 /proc/loadavg) "
    # note 1: left section is: docker images, number of exited containers, number of running containers
    # note: /proc/loadavg provides the load on the cpu over 1, 5, and 15 minutes
